$(function () {
    $(".banner").each(function () {
        var e = $(this); var pointer = e.attr("data-pointer"); var interval = e.attr("data-interval"); var style = e.attr("data-style"); var items = e.attr("data-item"); var items_s = e.attr("data-small"); var items_m = e.attr("data-middle"); var items_b = e.attr("data-big"); var num = e.find(".carousel .item").length; var win = $(window).width(); var i = 1; if (interval == null) { interval = 5 } if (items == null || items < 1) { items = 1 } if (items_s != null && win > 760) { items = items_s } if (items_m != null && win > 1000) { items = items_m } if (items_b != null && win > 1200) { items = items_b } var itemWidth = Math.ceil(e.outerWidth() / items); var page = Math.ceil(num / items); e.find(".carousel .item").css("width", itemWidth + "px"); e.find(".carousel").css("width", itemWidth * num + "px"); var carousel = function () { i++; if (i > page) { i = 1 } $showbanner(e, i, items, num) }; var play = setInterval(carousel, interval * 600); e.mouseover(function () { clearInterval(play) }); e.mouseout(function () { play = setInterval(carousel, interval * 600) }); if (pointer != 0 && page > 1) {
            var point = '<ul class="pointer"><li value="1" class="active"></li>'; for (var j = 1; j < page; j++) { point = point + ' <li value="' + (j + 1) + '"></li>' } point = point + "</ul>"; var pager = $(point); if (style != null) { pager.addClass(style) } e.append(pager); pager.css("left", e.outerWidth() * 0.5 - pager.outerWidth() * 0.5 + "px");
            pager.find("li").click(function () { $showbanner(e, $(this).val(), items, num) }); var lefter = $('<div class="pager-prev icon-angle-left"></div>'); var righter = $('<div class="pager-next icon-angle-right"></div>'); if (style != null) { lefter.addClass(style); righter.addClass(style) } e.append(lefter); e.append(righter); lefter.click(function () { i--; if (i < 1) { i = page } $showbanner(e, i, items, num) }); righter.click(function () { i++; if (i > page) { i = 1 } $showbanner(e, i, items, num) })
        }
    }); $showbanner = function (e, i, items, num) { var after = 0, leftx = 0; leftx = -Math.ceil(e.outerWidth() / items) * (items) * (i - 1); if (i * items > num) { after = i * items - num; leftx = -Math.ceil(e.outerWidth() / items) * (num - items) } e.find(".carousel").stop(true, true).animate({ "left": leftx + "px" }, 800); e.find(".pointer li").removeClass("active"); e.find(".pointer li").eq(i - 1).addClass("active") }; $(".spy a").each(function () { var e = $(this); var t = e.closest(".spy"); var target = t.attr("data-target"); var top = t.attr("data-offset-spy"); var thistarget = ""; var thistop = ""; if (top == null) { top = 0 } if (target == null) { thistarget = $(window) } else { thistarget = $(target) } thistarget.bind("scroll", function () { if (target == null) { thistop = $(e.attr("href")).offset().top - $(window).scrollTop() - parseInt(top) } else { thistop = $(e.attr("href")).offset().top - thistarget.offset().top - parseInt(top) } if (thistop < 0) { t.find("li").removeClass("active"); e.parents("li").addClass("active") } }) }); $(".fixed").each(function () { var e = $(this); var style = e.attr("data-style"); var top = e.attr("data-offset-fixed"); if (top == null) { top = e.offset().top } else { top = e.offset().top - parseInt(top) } if (style == null) { style = "fixed-top" } $(window).bind("scroll", function () { var thistop = top - $(window).scrollTop(); if (style == "fixed-top" && thistop < 0) { e.addClass("fixed-top") } else { e.removeClass("fixed-top") } var thisbottom = top - $(window).scrollTop() - $(window).height(); if (style == "fixed-bottom" && thisbottom > 0) { e.addClass("fixed-bottom") } else { e.removeClass("fixed-bottom") } }) }); $(".wx-share-btn").click(function () { $(".wx-share").show() }); $(".wx-share").click(function () { $(this).hide() }); $(".wx-comments-input").keydown(function () { var txt_num = (120 - parseInt($(this).val().length)); $(".wx-comments-num").html(txt_num) })
});
